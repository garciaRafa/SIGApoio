{% extends "base.html" %}

{% block content %}

<style>
    #ReservaFormDom {
        max-width: 70%;
    }
</style>

<h1 class="text-center mt-4 pt-4 blue-text">Editar Reserva Semanal</h1>
<form action="{% url 'editar_reserva_semanal' id=reserva.pk %}" method="POST" id="ReservaFormDom" locais_url="{% url 'getLocais' %}" reserva={{ reserva }} class="container text-start">
    {% csrf_token %}
    <hr class="ms-md-4 me-md-4 blue-text">
    {% if message %}
    <h5 class="{% if error %}text-danger{% else %}text-success{% endif %} text-center">{{ message }}</h5>
    {% endif %}
    <div class="px-md-4 pb-4">
        <h5>Descrição</h5>
        {{ form.descricao }}
    </div>
    <div class="d-flex justify-content-between gap-4 mb-4 px-md-4 flex-column flex-md-row">
        <div class="flex-fill">
            <h5>Dias</h5>
            {{ form.dias }}
        </div>
        <div class="flex-fill">
            <h5>Horários</h5>
            {{ form.horarios }}
        </div>
    </div>
    <div class="px-4 pb-4">
        <h5>Solicitante da reserva</h5>
        {{ form.matSolicitante }}
    </div>
    <div class="px-4 pb-4">
        <h5>Local</h5>
        {{ form.local }}
    </div>
    <div class="text-end me-2 pe-4 pb-4 mb-4">
        <button class="btn blue-btn btn-primary" type="submit">Enviar</button>
    </div>
</form>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<script type="text/javascript">

    $(document).ready(() => {
        const horarios = {{ reserva.horarios_form }}
        const dias = {{ reserva.dias }}
        $('#id_descricao').val('{{ reserva.descricao }}');
        $('#id_dias option').each(function() {
            if (dias.includes($(this).val())) {
                
                $(this).prop('selected', true);  // se o valor da opção estiver no vetor dias, marca como selecionado
            }
        });
        $('#id_horarios option').each(function() {
            if (horarios.includes($(this).val())) {
                $(this).prop('selected', true);  // se o valor da opção estiver no vetor horarios, marca como selecionado
            }
        });
        $('#id_local').html('<option selected disabled>{{ reserva.local }}</option>');
    })

</script>

{% endblock content %}